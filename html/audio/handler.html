<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Audio Handler</title>
</head>
<body>
    <script>
        let audioElement = null;
        let currentVolume = 0.5;

        window.addEventListener('message', (e) => {
            const data = e.data;

            if (data.action === 'playAudio') {
                playAudio(data.file, data.volume, data.is3D);
            } else if (data.action === 'stopAudio') {
                stopAudio();
            } else if (data.action === 'updateVolume') {
                updateVolume(data.volume);
            }
        });

        function playAudio(file, volume, is3D) {
            stopAudio();

            audioElement = new Audio(file);
            audioElement.volume = volume !== undefined ? volume : currentVolume;

            audioElement.play().catch(err => {
                console.error('Audio playback error:', err);
            });
        }

        function stopAudio() {
            if (audioElement) {
                audioElement.pause();
                audioElement.currentTime = 0;
                audioElement = null;
            }
        }

        function updateVolume(volume) {
            currentVolume = Math.max(0, Math.min(1, volume));
            
            if (audioElement) {
                audioElement.volume = currentVolume;
            }
        }
    </script>
</body>
</html>